if(!Array.indexOf){Array.prototype.indexOf=function(e){for(var t=0;t<this.length;t++){if(this[t]==e){return t}}return-1}}(function(e){var t="";var n={};var r={init:function(r){t=e(this).html();n=r;var i=e.extend({},e.fn.quizyMemoryGame.defaults,r);var s=e(this).children("ul").children("li").length;var o=new Array;var u=new Array;var a=new Array;var f="quizy-mg-item";var l="";var c=-1;var h=0;var p=0;var d=0;var v=0;var m;var g=i.openDelay;var y=i.itemWidth;var b=i.itemHeight;var w=i.itemsMargin;var E=Math.ceil(s/i.colCount);var S=i.randomised;var x=function(){if(p==0)m=setInterval(A,1e3);p++;var t=e(this).attr("id");var n=parseInt(t.substring(f.length,t.length));var r=u[n];T(e(this));C(e(this),n);if(h==0){h++;l=r;c=t}else if(h==1){h=0;if(r==l){L("correct");T(e("."+r));o.push(t);o.push(c);d++;if(d==s/2){clearInterval(m);if(i.gameSummary){e("div#quizy-game-summary").children("div#gs-column2").html(v+"<br>"+i.textSummaryTime);e("div#quizy-game-summary").children("div#gs-column3").html(p+"<br>"+i.textSummaryClicks);e("div#quizy-game-summary").delay(2e3).fadeIn(1e3)}if(i.onFinishCall!=""){i.onFinishCall({clicks:p,time:v})}}}else{L("wrong");T(e("div."+f));k(e("div#"+c));k(e(this));setTimeout(function(){e("."+f).each(function(){var t=e(this).attr("id");if(o.indexOf(t)==-1){N(e(this))}})},g+i.animSpeed+250)}}};var T=function(e){e.unbind("click");e.css("cursor","default")};var N=function(e){e.bind("click",x);e.css("cursor","pointer")};var C=function(t,n){var r=t.children("div.quizy-mg-item-top").attr("id");switch(i.animType){default:case"fade":O(t,n);e("#"+r).fadeOut(i.animSpeed);break;case"flip":t.flip({direction:i.flipAnim,speed:i.animSpeed,content:t.children("div.quizy-mg-item-bottom"),color:"#777",onEnd:function(){M(t,n)}});break;case"scroll":O(t,n);e("#"+r).animate({height:"toggle",opacity:.3},i.animSpeed);break}};var k=function(t){var n=t.children("div.quizy-mg-item-top").attr("id");switch(i.animType){default:case"fade":e("#"+n).delay(g).fadeIn(i.animSpeed,function(){_(t)});break;case"flip":setTimeout(function(){t.revertFlip()},g);setTimeout(function(){_(t)},g+i.animSpeed*4);break;case"scroll":e("#"+n).delay(g).animate({height:"toggle",opacity:1},i.animSpeed,function(){_(t)});break}};var L=function(t){if(i.resultIcons){var n;var r=Math.round(g/3);if(t=="wrong"){n=e("div#quizy-mg-msgwrong")}else if(t=="correct"){n=e("div#quizy-mg-msgcorrect")}n.delay(r).fadeIn(r/2).delay(r/2).hide("explode",r/2)}};var A=function(){v++};var O=function(e,t){e.children(".quizy-mg-item-bottom").children(".mgcard-show").html(a[t])};var M=function(e,t){e.children(".mgcard-show").html(a[t])};var _=function(e){e.children(".quizy-mg-item-bottom").children(".mgcard-show").html("")};e(this).children("ul").hide();e(this).css({height:E*(b+w)+"px"});if(S){var D=Array();for(var P=0;P<s;P++){a[P]="";D.push(P)}}var P=0;var H=0;while(H<s){if(S){var B=Math.floor(Math.random()*D.length);P=D[B];D.splice(B,1)}else{P=H}var j=e(this).children("ul").children("li").eq(P);var F=(H+i.colCount)%i.colCount;var I=Math.floor(H/i.colCount);var q=F*(y+w);var R=I*(b+w);a[P]=j.html();e(this).append('<div id="'+f+P+'" class="'+f+'" style="width:'+y+"px; height:"+b+"px; left:"+q+"px; top:"+R+'px">'+'<div class="quizy-mg-item-bottom"><div class="mgcard-show">'+'</div></div><div id="quizy-mg-item-top'+P+'" class="quizy-mg-item-top" style="width:'+y+"px; height:"+b+'px;"></div></div>');H++;u[P]=j.attr("class")}e(this).children("ul").remove();if(i.resultIcons){e(this).append('<div id="quizy-mg-msgwrong"'+' class="quizy-mg-notification-fly quizy-mg-notification-fly-neg"></div>'+'<div id="quizy-mg-msgcorrect" class="quizy-mg-notification-fly '+' quizy-mg-notification-fly-pos"></div>');var U=e(this).width()/2-e("div.quizy-mg-notification-fly").width()/2;var z=e(this).height()/2-e("div.quizy-mg-notification-fly").height()/2-i.itemsMargin/2;e("div.quizy-mg-notification-fly").css({top:z+"px",left:U+"px"})}if(i.gameSummary){var W=e(this);W.append('<div id="quizy-game-summary"><div class="gs-column" id="gs-column1">'+i.textSummaryTitle+'</div><div class="gs-column" id="gs-column2"></div>'+'<div class="gs-column" id="gs-column3"></div>'+'<div class="quizy-game-clear"></div></div>');var U=W.width()/2-e("div#quizy-game-summary").width()/2;var z=W.height()/2-e("div#quizy-game-summary").height()/2-i.itemsMargin/2;e("div#quizy-game-summary").css({top:z+"px",left:U+"px"});if(i.replayButton){e("#quizy-game-summary").append('<div id="gs-replaybut">'+i.replayButtonText+"</div>")}e("#quizy-game-summary").append('<div id="gs-closebut">'+i.closeButtonText+"</div>");e("div#gs-closebut").click(function(){e(this).parent().fadeOut()});e("div#gs-replaybut").click(function(){W.quizyMemoryGame("restart")})}e(".quizy-mg-item").click(x)},destroy:function(){e(this).empty()},restart:function(){r.destroy.apply(this);e(this).append(t);r.init.call(this,n)}};e.fn.quizyMemoryGame=function(t){if(r[t]){return r[t].apply(this,arguments)}else if(typeof t==="object"||!t){return r.init.apply(this,arguments)}else{e.error("Method "+t+" does not exist on jQuery.tooltip")}};e.fn.quizyMemoryGame.defaults={itemWidth:156,itemHeight:156,itemsMargin:10,colCount:4,animType:"scroll",animSpeed:250,openDelay:2500,flipAnim:"rl",resultIcons:true,gameSummary:true,randomised:true,textSummaryTitle:"Your game summary",replayButton:true,replayButtonText:"Replay",closeButtonText:"Close",textSummaryClicks:"clicks",textSummaryTime:"seconds",onFinishCall:""}})(jQuery)